Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 20
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	convert_ref
	1	convert_restore_fastq
	1	merge_graft_host
	1	sherman
	1	stat_accuracy
	1	stat_read_number
	1	xengsort_classify
	1	xengsort_idx
	9

[Fri Jul  4 00:03:17 2025]
rule convert_ref:
    input: /mnt/ccrsf-ifx/RefGenomes/SingleCell_REF/10X/hg38/refdata-gex-GRCh38-2024-A/fasta/genome.fa, /mnt/ccrsf-ifx/RefGenomes/mm10_all/mm10.fdb.fa
    output: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/ref_idx/graft_cvt.fa, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/ref_idx/host_cvt.fa
    jobid: 4


[Fri Jul  4 00:03:17 2025]
rule sherman:
    input: /mnt/ccrsf-ifx/RefGenomes/SingleCell_REF/10X/hg38/refdata-gex-GRCh38-2024-A/fasta/genome.fa, /mnt/ccrsf-ifx/RefGenomes/mm10_all/mm10.fdb.fa
    output: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/graft/sherman.log, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/host/sherman.log, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/simulated_bs_graft_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/simulated_bs_graft_R2.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/simulated_bs_host_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/simulated_bs_host_R2.fastq.gz
    jobid: 7

converting c2t/g2a in /mnt/ccrsf-ifx/RefGenomes/SingleCell_REF/10X/hg38/refdata-gex-GRCh38-2024-A/fasta/genome.fa to /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/ref_idx/graft_cvt.fa
[Fri Jul  4 00:04:10 2025]
Finished job 7.
1 of 9 steps (11%) done

[Fri Jul  4 00:04:10 2025]
rule merge_graft_host:
    input: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/simulated_bs_graft_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/simulated_bs_graft_R2.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/simulated_bs_host_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/simulated_bs_host_R2.fastq.gz
    output: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bs_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bs_R2.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bscvt_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bscvt_R2.fastq.gz
    jobid: 5

[convert-reads] CMD1: zcat /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bs_R1.fastq.gz | awk 'NR%4==1{getline seq; print $0 " ORIGINAL_SEQ:" seq; print seq; getline; print $0; getline; print $0}' | sed '2~4s/C/T/g;2~4s/c/t/g' | gzip > /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bscvt_R1.fastq.gz
[convert-reads] CMD2: zcat /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bs_R2.fastq.gz | awk 'NR%4==1{getline seq; print $0 " ORIGINAL_SEQ:" seq; print seq; getline; print $0; getline; print $0}' | sed '2~4s/G/A/g;2~4s/g/a/g' | gzip > /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bscvt_R2.fastq.gz
[Fri Jul  4 00:04:20 2025]
Finished job 5.
2 of 9 steps (22%) done

[Fri Jul  4 00:04:20 2025]
rule xengsort_classify:
    input: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bscvt_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bscvt_R2.fastq.gz
    output: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/classify.log, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-graft.1.fq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-graft.2.fq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-host.1.fq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-host.2.fq.gz
    jobid: 8

/mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/ref_idx/graft_cvt.fa
converting c2t/g2a in /mnt/ccrsf-ifx/RefGenomes/mm10_all/mm10.fdb.fa to /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/ref_idx/host_cvt.fa
[Fri Jul  4 00:04:36 2025]
Finished job 8.
3 of 9 steps (33%) done

[Fri Jul  4 00:04:36 2025]
rule convert_restore_fastq:
    input: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-graft.1.fq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-graft.2.fq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-host.1.fq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-host.2.fq.gz
    output: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_graft_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_graft_R2.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_host_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_host_R2.fastq.gz
    jobid: 6

[restore-fastq] CMD1: zcat /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-graft.1.fq.gz | awk 'NR%4==1{split($0, h, " ORIGINAL_SEQ:"); header=h[1]; orig_seq=h[2]} NR%4==2{seq=$0} NR%4==3{plus=$0} NR%4==0{qual=$0; print header "\n" orig_seq "\n" plus "\n" qual}' | gzip > /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_graft_R1.fastq.gz
[restore-fastq] CMD2: zcat /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-graft.2.fq.gz | awk 'NR%4==1{split($0, h, " ORIGINAL_SEQ:"); header=h[1]; orig_seq=h[2]} NR%4==2{seq=$0} NR%4==3{plus=$0} NR%4==0{qual=$0; print header "\n" orig_seq "\n" plus "\n" qual}' | gzip > /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_graft_R2.fastq.gz
[restore-fastq] CMD1: zcat /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-host.1.fq.gz | awk 'NR%4==1{split($0, h, " ORIGINAL_SEQ:"); header=h[1]; orig_seq=h[2]} NR%4==2{seq=$0} NR%4==3{plus=$0} NR%4==0{qual=$0; print header "\n" orig_seq "\n" plus "\n" qual}' | gzip > /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_host_R1.fastq.gz
[restore-fastq] CMD2: zcat /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/xengsort_classify/xengsort_classify-host.2.fq.gz | awk 'NR%4==1{split($0, h, " ORIGINAL_SEQ:"); header=h[1]; orig_seq=h[2]} NR%4==2{seq=$0} NR%4==3{plus=$0} NR%4==0{qual=$0; print header "\n" orig_seq "\n" plus "\n" qual}' | gzip > /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_host_R2.fastq.gz
[Fri Jul  4 00:04:37 2025]
Finished job 6.
4 of 9 steps (44%) done

[Fri Jul  4 00:04:37 2025]
rule stat_accuracy:
    input: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bscvt_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_graft_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_host_R1.fastq.gz
    output: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/accuracy_stat.txt
    jobid: 3


[Fri Jul  4 00:04:37 2025]
rule stat_read_number:
    input: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/sim_reads/merged_simulated_bscvt_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_graft_R1.fastq.gz, /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_host_R1.fastq.gz
    output: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/read_number_stat.txt
    jobid: 2

Traceback (most recent call last):
  File "/mnt/ccrsf-ifx/Software/github/methXsort/scripts/simulate_reads/stat_accuracy.py", line 80, in <module>
    main()
    ~~~~^^
  File "/mnt/ccrsf-ifx/Software/github/methXsort/scripts/simulate_reads/stat_accuracy.py", line 63, in main
    print(f"Fraction host (wrong IDs): {len(true_host_ids_wrong)/n_host:.4f}")
                                        ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
ZeroDivisionError: division by zero
[Fri Jul  4 00:04:37 2025]
Error in rule stat_accuracy:
    jobid: 3
    output: /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/accuracy_stat.txt
    shell:
        
python /mnt/ccrsf-ifx/Software/github/methXsort/scripts/simulate_reads/stat_accuracy.py 100000              /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_host_R1.fastq.gz,host  /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/fastq/bbsplit_graft_R1.fastq.gz,graft               > /mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/accuracy_stat.txt

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job stat_accuracy since they might be corrupted:
/mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/accuracy_stat.txt
[Fri Jul  4 00:04:37 2025]
Finished job 2.
5 of 9 steps (56%) done
/mnt/ccrsf-ifx/Software/github/methXsort/data/sherman_reads_100k_xengsort/ref_idx/host_cvt.fa
[Fri Jul  4 00:05:34 2025]
Finished job 4.
6 of 9 steps (67%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /mnt/ccrsf-ifx/Software/github/methXsort/data/.snakemake/log/2025-07-04T000317.758935.snakemake.log
